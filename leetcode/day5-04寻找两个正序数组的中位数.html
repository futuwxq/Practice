<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // var findMedianSortedArrays = function(nums1, nums2) {
        //     const arr = []
        //     const n1 = nums1.length,
        //         n2 = nums2.length

        //     //  flag 为 0 表示中位数是两个数组元素的平均数，为 1 表示是数组元素
        //     const flag = (n1 + n2) % 2 == 0 ? 0 : 1
        //         // 中位数在arr 数组中的位置是midn 或者 是midn 和 midn+1 的平均数
        //     const midn = Math.ceil((n1 + n2) / 2) - 1

        //     // 数组1 所有元素小于 数组2
        //     if (nums1[n1 - 1] <= nums2[0]) {
        //         nums1.push.apply(nums1, nums2)
        //         return flag == 0 ? (nums1[midn] + nums1[midn + 1]) / 2 : nums1[midn]
        //             //  数组2 所有元素小于 数组1
        //     } else if (nums2[n2 - 1] <= nums1[0]) {
        //         nums2.push.apply(nums2, nums1)
        //         return flag == 0 ? (nums2[midn] + nums2[midn + 1]) / 2 : nums2[midn]
        //     }

        //     let i = 0,
        //         j = 0;
        //     while (i < n1 && j < n2) {
        //         if (nums1[i] <= nums2[j]) {
        //             arr.push(nums1[i])
        //             i++
        //         } else {
        //             arr.push(nums2[j])
        //             j++
        //         }
        //         // if(i = n1)
        //     }
        //     // 数组1中还存在元素
        //     while (i < n1) {
        //         arr.push(nums1[i])
        //         i++
        //     }
        //     // 数组2中还存在元素
        //     while (j < n2) {
        //         arr.push(nums2[j])
        //         j++
        //     }
        //     return flag == 0 ? (arr[midn] + arr[midn + 1]) / 2 : arr[midn]
        // };
        var findMedianSortedArrays = function(nums1, nums2) {
            // 第一个数组个数是最少的
            if (nums1.length > nums2.length) {
                [nums1, nums2] = [nums2, nums1]
            }

            const m = nums1.length
            const n = nums2.length

            // 分割线左边的所有元素需要满足的个数是 (m + n + 1) / 2
            const totalLeft = Math.floor((m + n + 1) / 2);

            // 在第一个数组的区间 [0,m] 里查找恰当的分割线
            // 是的 num1[i-1] <= nums2[j] && nums2[j-1] <= nums1[i]
            //  i 是第一个数组分割线右边的第一个元素下标 ， j 是第二个数组分割线右边的第一个元素下标
            let left = 0,
                right = m

            while (left <= right) //为了保证 num1 数组下标不会越界
            {
                const i = left + Math.floor((right - left) / 2)
                const j = totalLeft - i
                const nums1LeftMax = i === 0 ? -Infinity : nums1[i - 1]
                const nums1RgihtMin = i === m ? Infinity : nums1[i]
                const nums2LeftMax = j === 0 ? -Infinity : nums2[j - 1]
                const nums2RightMin = j === n ? Infinity : nums2[j]
                    // if (nums2[j - 1] > nums1[i]) {
                    //     left = i + 1 // num2 左侧的数据 大于 num1 右侧数据（num1右侧数据小了，num2左侧数据大了），此时应该 num1 的分割线右移 ，num2 分割线左移
                    //         // 也说明此时 num1 分割线左侧的数据不需要筛选 二分区间变为 [left,i + 1]
                    // } else {

                //     right = i // num2 左侧数据 小于 num1右侧数据 满足一边条件，还需要判断，num1左侧数据是否 小于 num2 右侧数据，因此num1的分割线左移，num2的分割线右移
                //         // 下一轮搜索的区间 [left,i]
                // }
                if (nums1LeftMax <= nums2RightMin && nums1RgihtMin >= nums2LeftMax) { //nums1 左侧的数据小于 num2 右侧的数据 num1 右侧的值 大于num2 左侧的数据
                    return (m + n) % 2 === 1 ?
                        Math.max(nums1LeftMax, nums2LeftMax) :
                        (Math.max(nums1LeftMax, nums2LeftMax) + Math.min(nums1RgihtMin, nums2RightMin)) / 2
                } else if (nums1LeftMax > nums2RightMin) { // num1 左侧数据 大于 num2右侧数据 分割线左移
                    right = i - 1
                } else {
                    left = left + 1 // num1 右侧数据 小于 num2左侧数据 分割线右移
                }
            }
        }

        const s1 = [1, 3],
            s2 = [2]
        const res = findMedianSortedArrays(s1, s2)
        console.log(res);
    </script>
</body>

</html>